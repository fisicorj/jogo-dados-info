<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exploradores de Dados</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1 id="title">Exploradores de Dados</h1>
        
        <label for="language-select" id="language-label">Escolha o idioma:</label>
        <select id="language-select" onchange="changeLanguage()">
            <option value="pt">Português</option>
            <option value="en">English</option>
            <option value="es">Español</option>
            <option value="de">Deutsch</option>
        </select>
        
        <p id="instructions">Clique no botão para gerar um conjunto de dados brutos.</p>
        <button onclick="generateData()" id="generate-btn" disabled>Gerar Dados</button>
        <button onclick="resetData()" id="reset-btn">Resetar</button>
        <div id="data-container" class="data-box"></div>
        
        <p id="choose-transformation">Escolha uma transformação para aplicar aos dados:</p>
        <button onclick="transformData('media')" id="mean-btn">Calcular Média</button>
        <button onclick="transformData('ordenar')" id="sort-btn">Ordenar</button>
        <button onclick="transformData('contagem')" id="count-btn">Contagem</button>
        <button onclick="transformData('categorizar')" id="categorize-btn">Categorizar</button>
        
        <h2 id="result-title">Resultado</h2>
        <div id="result" class="result-box"></div>
        
        <h2 id="rules-title">Regras do Jogo</h2>
        <p id="rules-text">1. Clique em "Gerar Dados" para obter um conjunto aleatório de dados.<br>
        2. Escolha uma transformação para modificar os dados.<br>
        3. Observe os resultados e compare as diferenças.<br>
        4. Clique em "Resetar" para iniciar novamente.</p>
    </div>

    <div id="loading-spinner" style="display:none;">Carregando dados...</div>

    <script>
        let currentData = [];
        let externalData = {};
        let selectedLanguage = "pt";

        async function loadExternalData() {
            document.getElementById("loading-spinner").style.display = "block";
            try {
                const response = await fetch('dados_massivos.json');
                externalData = await response.json();
                document.getElementById("generate-btn").disabled = false;
            } catch (error) {
                console.error("Erro ao carregar dados externos", error);
            } finally {
                document.getElementById("loading-spinner").style.display = "none";
            }
        }

        function generateData() {
            if (externalData[selectedLanguage]?.length > 0) {
                currentData = externalData[selectedLanguage][Math.floor(Math.random() * externalData[selectedLanguage].length)];
                document.getElementById("data-container").innerText = `Dados: ${currentData.join(", ")}`;
                document.getElementById("result").innerText = "";
				document.getElementById("generate-btn").disabled = true;
                document.getElementById("generate-btn").classList.add("disabled-button");
            } else {
                document.getElementById("data-container").innerHTML = "<span style='color: red;'>Erro ao carregar dados. Verifique o JSON.</span>";
            }
        }

        function changeLanguage() {
            selectedLanguage = document.getElementById("language-select").value;
            generateData();  // Atualiza os dados para o novo idioma
            Object.keys(translations[selectedLanguage]).forEach(id => {
                document.getElementById(id).innerHTML = translations[selectedLanguage][id];
            });
        }

        function resetData() {
            currentData = [];
            document.getElementById("data-container").innerText = "";
            document.getElementById("result").innerText = "";
			document.getElementById("generate-btn").disabled = false;
            document.getElementById("generate-btn").classList.remove("disabled-button");
        }

        function transformData(action) {
            let result = "";
            if (currentData.length === 0) {
                result = "Por favor, gere um conjunto de dados primeiro!";
            } else {
                switch (action) {
                    case 'media':
                        if (currentData.every(n => typeof n === 'number')) {
                            const sum = currentData.reduce((acc, num) => acc + num, 0);
                            result = `Média: ${(sum / currentData.length).toFixed(2)}`;
                        } else {
                            result = "Não é possível calcular a média para esses dados.";
                        }
                        break;
                    case 'ordenar':
                        result = `Ordenado: ${[...currentData].sort((a, b) => a - b).join(", ")}`;
                        break;
                    case 'contagem':
                        const countMap = {};
                        currentData.forEach(item => countMap[item] = (countMap[item] || 0) + 1);
                        result = `<strong>Contagem:</strong><ul>${Object.entries(countMap).map(([key, value]) => `<li>${key}: ${value}</li>`).join("")}</ul>`;
                        break;
                    case 'categorizar':
                        result = `Categorias: ${currentData.join(" - ")}`;
                        break;
                    default:
                        result = "Ação desconhecida";
                }
            }
            document.getElementById("result").innerHTML = result;
        }

        let translations = {
            "pt": {
                "language-label": "Escolha o idioma:",
				"title": "Exploradores de Dados",
                "instructions": "Clique no botão para gerar um conjunto de dados brutos.",
                "generate-btn": "Gerar Dados",
                "reset-btn": "Resetar",
                "choose-transformation": "Escolha uma transformação para aplicar aos dados:",
                "mean-btn": "Calcular Média",
                "sort-btn": "Ordenar",
                "count-btn": "Contagem",
                "categorize-btn": "Categorizar",
                "result-title": "Resultado",
                "rules-title": "Regras do Jogo",
                "rules-text": "1. Clique em \"Gerar Dados\" para obter um conjunto aleatório de dados.<br>2. Escolha uma transformação para modificar os dados.<br>3. Observe os resultados e compare as diferenças.<br>4. Clique em \"Resetar\" para iniciar novamente."
            },
            "en": {
                "language-label": "Choose the language:",
				"title": "Data Explorers,
                "instructions": "Click the button to generate a set of raw data.",
                "generate-btn": "Generate Data",
                "reset-btn": "Reset",
                "choose-transformation": "Choose a transformation to apply to the data:",
                "mean-btn": "Calculate Mean",
                "sort-btn": "Sort",
                "count-btn": "Count",
                "categorize-btn": "Categorize",
                "result-title": "Result",
                "rules-title": "Game Rules",
                "rules-text": "1. Click \"Generate Data\" to get a random dataset.<br>2. Choose a transformation to modify the data.<br>3. Observe the results and compare the differences.<br>4. Click \"Reset\" to start again."
            },
			"es": {
                "language-label": "Exploradores de Datos:",
				"title": "Juego de Datos e Información",
                "instructions": "Haz clic en el botón para generar un conjunto de datos sin procesar.",
                "generate-btn": "Generar Datos",
                "reset-btn": "Reiniciar",
                "choose-transformation": "Elige una transformación para aplicar a los datos:",
                "mean-btn": "Calcular Media",
                "sort-btn": "Ordenar",
                "count-btn": "Contar",
                "categorize-btn": "Categorizar",
                "result-title": "Resultado",
                "rules-title": "Reglas del Juego",
                "rules-text": "1. Haz clic en \"Generar Datos\" para obtener un conjunto de datos aleatorio.<br>2. Elige una transformación para modificar los datos.<br>3. Observa los resultados y compara las diferencias.<br>4. Haz clic en \"Reiniciar\" para empezar de nuevo."
            },
            "de": {
                "language-label": "Wählen Sie die Sprache:",
				"title": "Datenforscher",
                "instructions": "Klicken Sie auf die Schaltfläche, um einen Rohdatensatz zu generieren.",
                "generate-btn": "Daten generieren",
                "reset-btn": "Zurücksetzen",
                "choose-transformation": "Wählen Sie eine Transformation für die Daten:",
                "mean-btn": "Mittelwert berechnen",
                "sort-btn": "Sortieren",
                "count-btn": "Zählen",
                "categorize-btn": "Kategorisieren",
                "result-title": "Ergebnis",
                "rules-title": "Spielregeln",
                "rules-text": "1. Klicken Sie auf \"Daten generieren\", um einen zufälligen Datensatz zu erhalten.<br>2. Wählen Sie eine Transformation, um die Daten zu ändern.<br>3. Beobachten Sie die Ergebnisse und vergleichen Sie die Unterschiede.<br>4. Klicken Sie auf \"Zurücksetzen\", um neu zu starten."
            }			
        };

        loadExternalData();
    </script>
</body>
</html>
